# No animations for terminal/file manager and some GTK/Qt tools for snappier feel
windowrule=noanim:1,appid:^(kitty)$
windowrule=noanim:1,appid:^(nemo)$
windowrule=noanim:1,appid:^(.*ct)$
windowrule=noanim:1,appid:^(.*manager)$
windowrule=noanim:1,appid:^(io.missioncenter.MissionCenter)$

# -----------------------------
# IDLE INHIBIT (keep monitor awake during playback)
# -----------------------------
windowrule=idleinhibit:1,appid:^(.*celluloid.*)$
windowrule=idleinhibit:1,appid:^(.*mpv.*)$
windowrule=idleinhibit:1,appid:^(.*vlc.*)$
windowrule=idleinhibit:1,appid:.*[Ss]potify.*
windowrule=idleinhibit:1,appid:.*(LibreWolf|floorp|Brave|firefox|chromium|zen|vivaldi).* 

# -----------------------------
# PICTURE-IN-PICTURE (floating, keep aspect, small size)
# -----------------------------
windowrule=float:1,title:^([Pp]icture[-\s]?[Ii]n[-\s]?[Pp]icture)(.*)$
windowrule=keepaspectratio:1,title:^([Pp]icture[-\s]?[Ii]n[-\s]?[Pp]icture)(.*)$
# Move to ~73% x,72% y (Mango's 'move' accepts percent-like args: x% y%)
windowrule=move:73% 72%,title:^([Pp]icture[-\s]?[Ii]n[-\s]?[Pp]icture)(.*)$
windowrule=size:25%,title:^([Pp]icture[-\s]?[Ii]n[-\s]?[Pp]icture)(.*)$
windowrule=pin:1,title:^([Pp]icture[-\s]?[Ii]n[-\s]?[Pp]icture)(.*)$
# -----------------------------
# FLOATING RULES (dialogs, terminals in top utilities)
# -----------------------------
windowrule=float:1,appid:^(org.kde.dolphin)$,title:^(Progress Dialog \u2014 Dolphin)$
windowrule=float:1,appid:^(org.kde.dolphin)$,title:^(Copying \u2014 Dolphin)$
windowrule=float:1,title:^(About Mozilla Firefox)$
windowrule=float:1,appid:^(firefox)$,title:^(Picture-in-Picture)$
windowrule=float:1,appid:^(firefox)$,title:^(Library)$
windowrule=float:1,appid:^(kitty)$,title:^(top)$
windowrule=float:1,appid:^(kitty)$,title:^(btop)$
windowrule=float:1,appid:^(kitty)$,title:^(htop)$
windowrule=float:1,appid:^(vlc)$
windowrule=float:1,appid:^(kvantummanager)$
windowrule=float:1,appid:^(qt5ct)$
windowrule=float:1,appid:^(qt6ct)$
windowrule=float:1,appid:^(nwg-look)$
windowrule=float:1,appid:^(org.kde.ark)$
windowrule=float:1,appid:^(org.pulseaudio.pavucontrol)$
windowrule=float:1,appid:^(blueman-manager)$
windowrule=float:1,appid:^(nm-applet)$
windowrule=float:1,appid:^(nm-connection-editor)$
windowrule=float:1,appid:^(org.kde.polkit-kde-authentication-agent-1)$

# Additional floating GTK apps
windowrule=float:1,appid:^(com.github.rafostar.Clapper)$
windowrule=float:1,appid:^(app.drey.Warp)$
windowrule=float:1,appid:^(net.davidotek.pupgui2)$
windowrule=float:1,appid:^(yad)$
windowrule=float:1,appid:^(eog)$
windowrule=float:1,appid:^(io.github.alainm23.planify)$
windowrule=float:1,appid:^(io.gitlab.theevilskeleton.Upscaler)$
windowrule=float:1,appid:^(com.github.unrud.VideoDownloader)$
windowrule=float:1,appid:^(io.gitlab.adhami3310.Impression)$
windowrule=float:1,appid:^(io.missioncenter.MissionCenter)$

# -----------------------------
# COMMON MODALS (file choosers, auth dialogs centered)
# -----------------------------
windowrule=float:1,title:^(Open)$
windowrule=float:1,title:^(Authentication Required)$
windowrule=float:1,title:^(Add Folder to Workspace)$
windowrule=float:1,title:^(Choose Files)$
windowrule=float:1,title:^(Save As)$
windowrule=float:1,title:^(Confirm to replace files)$
windowrule=float:1,title:^(File Operation Progress)$
windowrule=float:1,appid:^([Xx]dg-desktop-portal-gtk)$
windowrule=float:1,title:^(File Upload)(.*)$
windowrule=float:1,title:^(Choose wallpaper)(.*)$
windowrule=float:1,title:^(Library)(.*)$
windowrule=float:1,appid:^(.*dialog.*)$
windowrule=float:1,title:^(.*dialog.*)$
windowrule=nofocus:1,appid:^$,title:^$,xwayland:1,floating:1,fullscreen:0,pinned:0
windowrule=suppressevent:maximize,appid:.*

# -----------------------------
# LAYER RULES (blur + ignorezero + ignorealpha)
# -----------------------------
# We want rofi, notifications and control centers blurred for aesthetics, but we also
# include ignorezero/ignorealpha rules to avoid blank outputs on some setups.
layerrule=noblur:1,layer_name:selection        # slurp / region selector
layerrule=noblur:1,layer_name:wlroots-screencopy
layerrule=noblur:1,layer_name:slurp
layerrule=noblur:1,layer_name:rofi
layerrule=noblur:1,layer_name:notifications
layerrule=noblur:1,layer_name:swaync-notification-window
layerrule=noblur:1,layer_name:swaync-control-center
layerrule=noblur:1,layer_name:logout_dialog

# For any layer that may show black/transparent issues, keep ignorezero guard
layerrule=ignorezero:1,layer_name:selection
layerrule=ignorezero:1,layer_name:wlroots-screencopy
layerrule=ignorezero:1,layer_name:rofi
layerrule=ignorezero:1,layer_name:notifications

